import{j as s,r as a,a as _,g as v,d as J,f as D,o as K,c as X}from"./client-DayaVDz4.js";import{R as C,i as z,j as q,k as Q,U as Z,l as ee,m as te,n as re,H as ne,o as oe,p as se}from"./Header-OgusAenm.js";import{B as ae,C as ce,H as le,S as ie,R as ue,L as de,a as fe}from"./Statistics-BzO71dma.js";function Se({reference:d,left1:l,left2:r}){return s.jsx("div",{id:"subContainer",children:s.jsxs("div",{ref:d,id:"mainContainer",children:[s.jsx("img",{className:"mainImage",src:"./shared-assets/images/Roulette.png",style:{left:l}}),s.jsx("img",{className:"mainImage",src:"./shared-assets/images/Roulette.png",style:{left:r}}),s.jsx("img",{id:"arrowImage",src:"./shared-assets/images/RouletteArrowImage.png"})]})})}function Re({balance:d,spinInfo:l,setSpinInfo:r,isDisabled:g,StartEvent:A,historyArray:h}){return s.jsxs("div",{className:"sideContainer",children:[s.jsx(ae,{spinInfo:l,setSpinInfo:r,isDisabled:g}),s.jsx(ce,{spinInfo:l,setSpinInfo:r,isDisabled:g,colorValues:z,koafValues:C}),s.jsx(le,{historyArray:h}),s.jsx(ie,{page:"Roulette",balance:d,spinInfo:l,koafValues:C,isDisabled:g,StartEvent:A})]})}function me({balance:d,setBalance:l,spinInfo:r,setSpinInfo:g,isDisabled:A,setIsDisabled:h,historyArray:j,setHistoryArray:w,setLastGamesArray:p,setStatistics:y}){const R=a.useRef();a.useEffect(()=>{R.current&&B()},[R.current]);const i=a.useRef(0),f=a.useRef(0),m=a.useRef(2400),[T,O]=a.useState(f.current+i.current),[x,U]=a.useState(m.current+i.current);window.addEventListener("resize",()=>{R.current&&B()});function B(){const t=b()-600;i.current=t,O(f.current+i.current),U(m.current+i.current)}function b(){return window.getComputedStyle(R.current).width.replace("px","")/2}const[k,G]=a.useState(!1);a.useEffect(()=>{k&&(N(),G(!1))},[k]);const E=a.useRef(0);function P(){E.current=20+Math.random()*10,h(!0),l(t=>t-r.bet),H("start"),$()}function $(){F(E.current);const t=f.current+i.current,n=m.current+i.current;t<-200&&n<-200&&(t<n?(f.current+=2400,O(f.current+i.current)):(m.current+=2400,U(m.current+i.current)));let o;E.current>15?o=.1:E.current>10?o=.08:E.current>5?o=.06:E.current>2?o=.04:o=.03,E.current-=Math.random()*o,E.current<=0?(E.current=0,G(!0)):setTimeout($,10)}function N(){const t=b();let n=T<t&&x<t?T<x?x:T:T<t?T:x;console.log(`Final left is ${n}`);const o=Y(n),c=r.color==o,e=c?"5C9E5E":"9E5C5C",S=c?r.bet*(C[r.color]-1):r.bet;c&&l(u=>u+S+r.bet),W(e,o,c,S),V(e,r.color,o,r.bet,c?r.bet*C[r.color]:0),H("finish",c,o,r.bet*C[r.color]),h(!1)}function Y(t){t=Math.abs(-b()+t);let n,o=1/0;for(let L=40;L<=2360;L+=80){const I=Math.abs(t-L);I<o&&(o=I,n=L)}console.log(`Nearest position is ${n}`);let c;const e=[1160,2360],S=[120,280,440,600,760,920,1080,1240,1400,1560,1720,1880,2040,2200],u=[40,200,360,520,680,840,1e3,1320,1480,1640,1800,1960,2120,2280];return e.includes(n)?c="Purple":S.includes(n)?c="Black":u.includes(n)&&(c="Red"),console.log(`Final color is ${c}`),c}function F(t){f.current-=t,m.current-=t,O(f.current+i.current),U(m.current+i.current)}function W(t,n,o,c){const e=document.getElementById("resultContainer"),S=document.getElementById("resultColor"),u=document.getElementById("resultProfit");e.style.display="flex",e.style.background=`radial-gradient(#${t} 5%, #${t}77)`,S.textContent=`${n} x${C[n]}`,u.textContent=o?`+ ${c} $`:`- ${c} $`,setTimeout(()=>e.style.display="none",5e3)}function V(t,n,o,c,e){w(S=>{const u=[o,...S];return u.length>q&&u.pop(),u}),p(S=>{const u=[{bgColor:t,userColor:n,finalColor:o,betBefore:c,betAfter:e},...S];return u.length>Q&&u.pop(),u})}function H(t,n,o,c){t=="start"?y(e=>({...e,totalSpins:e.totalSpins+1,totalMoneyBet:e.totalMoneyBet+r.bet,redChoosed:e.redChoosed+(r.color=="Red"?1:0),blackChoosed:e.blackChoosed+(r.color=="Black"?1:0),purpleChoosed:e.purpleChoosed+(r.color=="Purple"?1:0)})):t=="finish"&&y(e=>({...e,totalWins:e.totalWins+(n?1:0),totalMoneyWon:e.totalMoneyWon+(n?c:0),winPercentage:Math.round((e.totalWins+(n?1:0))/e.totalSpins*1e3)/10,moneyProfit:e.totalMoneyWon+(n?c:0)-e.totalMoneyBet,redWon:e.redWon+(n&&o=="Red"?1:0),blackWon:e.blackWon+(n&&o=="Black"?1:0),purpleWon:e.purpleWon+(n&&o=="Purple"?1:0)}))}return s.jsxs("div",{className:"mainGameWindow",style:{background:"linear-gradient(to right, #50B85F, #3B9C96)"},children:[s.jsx(Se,{reference:R,left1:T,left2:x}),s.jsx(Re,{balance:d,spinInfo:r,setSpinInfo:g,isDisabled:A,StartEvent:P,historyArray:j}),s.jsx(ue,{})]})}function Ee(){const d=a.useRef(!1),[l,r]=a.useState(window.sessionStorage.getItem("balance"));a.useEffect(()=>{_.currentUser&&d.current&&Z(l)},[l]);async function g(){const T=await v(J(D,"users",_.currentUser.uid));r(T.data().balance),d.current=!0}_.currentUser&&!d.current&&g();const[A,h]=a.useState({bet:0,color:""}),[j,w]=a.useState(!1),[p,y]=a.useState(ee);a.useEffect(()=>{window.localStorage.setItem("ROULETTE_HISTORY_ARRAY",JSON.stringify(p))},[p]);const[R,i]=a.useState(te);a.useEffect(()=>{window.localStorage.setItem("ROULETTE_LAST_GAMES_ARRAY",JSON.stringify(R))},[R]);const[f,m]=a.useState(re);return a.useEffect(()=>{window.localStorage.setItem("ROULETTE_STATISTICS",JSON.stringify(f))},[f]),s.jsxs(s.Fragment,{children:[s.jsx(ne,{page:"Roulette",balance:l}),s.jsxs("main",{children:[s.jsx(me,{balance:l,setBalance:r,spinInfo:A,setSpinInfo:h,isDisabled:j,setIsDisabled:w,historyArray:p,setHistoryArray:y,setLastGamesArray:i,setStatistics:m}),s.jsx(de,{lastGamesArray:R}),s.jsx(fe,{statistics:f,statisticsTexts:se,statisticsChars:oe})]})]})}const Te=document.getElementById("root");let M;K(_,d=>{d?.emailVerified?console.log(`Signed in with uid ${d.uid}`):console.log("No signed in user"),M||(M=X.createRoot(Te)),M.render(s.jsx(a.StrictMode,{children:s.jsx(Ee,{})}))});
