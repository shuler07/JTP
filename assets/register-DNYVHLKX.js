import{r as m,j as e,b as R,a as g,e as p,s as C,h as k,g as F,d as E,f as T,i as B,k as I,o as N,c as V}from"./client-DayaVDz4.js";function L(){const[t,o]=m.useState(!0),[a,d]=m.useState(""),[r,u]=m.useState(""),[f,v]=m.useState(""),w=m.useRef(),[x,n]=m.useState("");m.useEffect(()=>{i()},[x]);function i(){if(x!==""){const s=w.current;s.style.display="block",s.style.animation="none",s.offsetWidth,s.style.animation="",s.style.animation="formAlertAnim 5s forwards";const c=()=>{s.style.display="none",s.removeEventListener("animationend",c)};s.addEventListener("animationend",c)}}function l(){window.location.href.endsWith("index.html")||(window.location.href="index.html")}return e.jsxs("div",{id:"formContainer",children:[e.jsx("img",{src:"./shared-assets/images/Logo180px.png",onClick:l,style:{cursor:"pointer"}}),e.jsx(j,{hint:"Email",type:"email",value:a,setValue:d}),e.jsx(j,{hint:"Password",type:"password",value:r,setValue:u}),t&&e.jsx(j,{hint:"Username",value:f,setValue:v}),e.jsx(W,{setAlert:n,animateAlert:i,isRegister:t,_email:a,_password:r,_username:f}),e.jsx(P,{isRegister:t,setIsRegister:o}),!t&&e.jsx(U,{email:a,setAlert:n,animateAlert:i}),e.jsx(D,{reference:w,alert:x})]})}function j({hint:t,type:o,value:a,setValue:d}){return e.jsxs("div",{className:"formField",children:[e.jsx("h6",{className:"formFieldHint",children:t}),e.jsx("input",{className:"formFieldInput",type:o,value:a,onChange:r=>d(r.target.value)})]})}function W({setAlert:t,animateAlert:o,isRegister:a,_email:d,_password:r,_username:u}){function f(){let n=x(d,r);n!=""?(t(n),o()):(n=a?v(d,r,u):w(d,r),n!=""&&(t(n),o()))}async function v(n,i,l,s="Invalid email or password. Try again later"){try{const h=(await R(g,n,i)).user;window.localStorage.setItem("username",l);try{await p(h),s="Confirm your email before you login"}catch(y){console.log(y.message)}C(g)}catch(c){console.log(c.message)}return s}async function w(n,i,l="Invalid email or password. Try again later"){try{const c=(await k(g,n,i)).user;if(c.emailVerified)try{const y=(await F(E(T,"users",c.uid))).data();if(y)window.localStorage.setItem("username",y.username),l="",window.location.href="index.html";else try{await B(E(T,"users",c.uid),{username:window.localStorage.getItem("username"),balance:0}),l="",window.location.href="index.html"}catch(A){console.log(A.message)}}catch(h){console.log(h.message)}else{try{await p(c),l="Confirm your email before you login"}catch(h){console.log(h.message)}C(g)}}catch(s){console.log(s.message)}return l}function x(n,i){const l=new Set(i);return i.length<8?"Short password":l.size<=i.length/3?"Too many repeating symbols":n==""?"Email field is empty":""}return e.jsx("div",{id:"formButtonContainer",children:e.jsx("button",{id:"formButton",onClick:f,children:e.jsx("h5",{className:"gradientText",children:a?"Register":"Login"})})})}function P({isRegister:t,setIsRegister:o}){return e.jsx("div",{id:"formButtonSwitchContainer",children:e.jsx("button",{id:"formButtonSwitch",className:"buttonWithUnderline",onClick:()=>o(!t),children:t?"Already have an account? Login":"Don't have an account? Register"})})}function U({email:t,setAlert:o,animateAlert:a}){function d(){r()}async function r(u="Invalid email or password. Try again later"){if(t=="")u="Email field is empty";else try{await I(g,t),u="Reset password email sent"}catch(f){console.log(f.message)}o(u),a()}return e.jsx("div",{id:"formButtonResetContainer",children:e.jsx("button",{id:"formButtonReset",className:"buttonWithUnderline",onClick:d,children:"Reset password"})})}function D({reference:t,alert:o}){return e.jsx("div",{ref:t,id:"formAlert",children:e.jsx("h6",{children:o})})}function H(){return e.jsxs(e.Fragment,{children:[e.jsx(L,{}),e.jsx("div",{className:"bgCircle little",style:{left:"25dvw",top:"65dvh"}}),e.jsx("div",{className:"bgCircle little",style:{left:"85dvw",top:"40dvh"}}),e.jsx("div",{className:"bgCircle medium",style:{left:"70dvw",top:"5dvh"}}),e.jsx("div",{className:"bgCircle medium",style:{left:"55dvw",top:"60dvh"}}),e.jsx("div",{className:"bgCircle large",style:{left:"5dvw",top:"10dvh"}})]})}const S=document.getElementById("root");let b;N(g,t=>{t?.emailVerified||(S.childElementCount==0&&(b=V.createRoot(S)),b.render(e.jsx(m.StrictMode,{children:e.jsx(H,{})})))});
