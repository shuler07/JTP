import{j as r,r as a,a as L,g as O,d as F,f as U,o as I,c as N}from"./client-DayaVDz4.js";import{W as f,a as V,b as D,c as P,U as v,d as J,e as K,f as X,H as q,g as z,h as Q}from"./Header-OgusAenm.js";import{B as Z,C as ee,H as te,S as oe,R as ne,L as re,a as se}from"./Statistics-BzO71dma.js";function ae({wheelAngle:c}){return r.jsxs("div",{id:"mainContainer",children:[r.jsx("img",{id:"mainImage",src:"./shared-assets/images/Wheel.png",style:{rotate:`${c}deg`}}),r.jsx("img",{id:"arrowImage",src:"./shared-assets/images/WheelArrow.png"}),r.jsx("div",{id:"mainBlur"})]})}function le({balance:c,spinInfo:u,setSpinInfo:o,isDisabled:S,StartEvent:A,historyArray:g}){return r.jsxs("div",{className:"sideContainer",children:[r.jsx(Z,{spinInfo:u,setSpinInfo:o,isDisabled:S}),r.jsx(ee,{spinInfo:u,setSpinInfo:o,isDisabled:S,colorValues:V,koafValues:f}),r.jsx(te,{historyArray:g}),r.jsx(oe,{page:"Wheel",balance:c,spinInfo:u,koafValues:f,isDisabled:S,StartEvent:A})]})}function ce({balance:c,setBalance:u,spinInfo:o,setSpinInfo:S,isDisabled:A,setIsDisabled:g,historyArray:_,setHistoryArray:T,setLastGamesArray:W,setStatistics:C}){const[h,x]=a.useState(0),[m,R]=a.useState(!1),y=a.useRef(0),l=a.useRef(0);a.useEffect(()=>{m&&(Y(),R(!1))},[m]);function G(){y.current=Math.random()<.5?1:-1,l.current=4+Math.random()*6,g(!0),u(e=>e-o.bet),M("start"),j()}function j(){x(e=>(e+l.current*y.current)%360),l.current>3?l.current-=Math.random()*.025:l.current>2?l.current-=Math.random()*.02:l.current>1?l.current-=Math.random()*.015:l.current>.5?l.current-=Math.random()*.01:l.current-=Math.random()*.004,l.current<=0?(x(e=>e>=0?e:e+360),l.current=0,y.current=0,R(!0)):setTimeout(j,10)}function Y(){console.log(`Final angle is ${h}`);const e=$(),n=o.color==e,s=n?"5C9E5E":"9E5C5C",i=n?o.bet*(f[o.color]-1):o.bet;n&&u(t=>t+i+o.bet),k(s,e,n,i),p(s,o.color,e,o.bet,n?o.bet*f[o.color]:0),M("finish",n,e,o.bet*f[o.color]),g(!1)}function $(){let e,n=1/0;for(let w=0;w<=360;w+=9){const H=Math.abs(h-w);H<n&&(n=H,e=w%360)}e-=225,e<0&&(e+=360),console.log(`Nearest degree is ${e}`);let s;const i=0,t=[45,180,225],E=[9,27,63,81,99,117,135,153,171,189,207,243,261,279,297,315,333,351],d=[18,36,54,72,90,108,126,144,162,198,216,234,252,270,288,306,324,342];return e==i?s="Green":t.includes(e)?s="Yellow":E.includes(e)?s="Black":d.includes(e)&&(s="Red"),console.log(`Final color is ${s}`),s}function k(e,n,s,i){const t=document.getElementById("resultContainer"),E=document.getElementById("resultColor"),d=document.getElementById("resultProfit");t.style.display="flex",t.style.background=`radial-gradient(#${e} 5%, #${e}77)`,E.textContent=`${n} x${f[n]}`,d.textContent=s?`+ ${i} $`:`- ${i} $`,setTimeout(()=>t.style.display="none",5e3)}function p(e,n,s,i,t){T(E=>{const d=[s,...E];return d.length>D&&d.pop(),d}),W(E=>{const d=[{bgColor:e,userColor:n,finalColor:s,betBefore:i,betAfter:t},...E];return d.length>P&&d.pop(),d})}function M(e,n,s,i){e=="start"?C(t=>({...t,totalSpins:t.totalSpins+1,totalMoneyBet:t.totalMoneyBet+o.bet,redChoosed:t.redChoosed+(o.color=="Red"?1:0),blackChoosed:t.blackChoosed+(o.color=="Black"?1:0),yellowChoosed:t.yellowChoosed+(o.color=="Yellow"?1:0),greenChoosed:t.greenChoosed+(o.color=="Green"?1:0)})):e=="finish"&&C(t=>({...t,totalWins:t.totalWins+(n?1:0),totalMoneyWon:t.totalMoneyWon+(n?i:0),winPercentage:Math.round((t.totalWins+(n?1:0))/t.totalSpins*1e3)/10,moneyProfit:t.totalMoneyWon+(n?i:0)-t.totalMoneyBet,redWon:t.redWon+(n&&s=="Red"?1:0),blackWon:t.blackWon+(n&&s=="Black"?1:0),yellowWon:t.yellowWon+(n&&s=="Yellow"?1:0),greenWon:t.greenWon+(n&&s=="Green"?1:0)}))}return r.jsxs("div",{className:"mainGameWindow",style:{background:"linear-gradient(to right, #4C9AFF, #9137BB)"},children:[r.jsx(ae,{wheelAngle:h}),r.jsx(le,{balance:c,spinInfo:o,setSpinInfo:S,isDisabled:A,StartEvent:G,historyArray:_}),r.jsx(ne,{})]})}function ie(){const c=a.useRef(!1),[u,o]=a.useState(window.sessionStorage.getItem("balance"));a.useEffect(()=>{L.currentUser&&c.current&&v(u)},[u]);async function S(){const y=await O(F(U,"users",L.currentUser.uid));o(y.data().balance),c.current=!0}L.currentUser&&!c.current&&S();const[A,g]=a.useState({bet:0,color:""}),[_,T]=a.useState(!1),[W,C]=a.useState(J);a.useEffect(()=>{window.localStorage.setItem("WHEEL_HISTORY_ARRAY",JSON.stringify(W))},[W]);const[h,x]=a.useState(K);a.useEffect(()=>{window.localStorage.setItem("WHEEL_LAST_GAMES_ARRAY",JSON.stringify(h))},[h]);const[m,R]=a.useState(X);return a.useEffect(()=>{window.localStorage.setItem("WHEEL_STATISTICS",JSON.stringify(m))},[m]),r.jsxs(r.Fragment,{children:[r.jsx(q,{page:"Wheel",balance:u}),r.jsxs("main",{children:[r.jsx(ce,{balance:u,setBalance:o,spinInfo:A,setSpinInfo:g,isDisabled:_,setIsDisabled:T,historyArray:W,setHistoryArray:C,setLastGamesArray:x,setStatistics:R}),r.jsx(re,{lastGamesArray:h}),r.jsx(se,{statistics:m,statisticsTexts:Q,statisticsChars:z})]})]})}const b=document.getElementById("root");let B;I(L,c=>{c?.emailVerified?console.log(`Signed in with uid ${c.uid}`):console.log("No signed in user"),b.childElementCount==0&&(B=N.createRoot(b)),B.render(r.jsx(a.StrictMode,{children:r.jsx(ie,{})}))});
